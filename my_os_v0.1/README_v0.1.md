# v0.1

## 文件结构

### bochsrc.disk  

bochs 的启动文件

### mbr.S 

1. 主引导汇编文件文件，大小为512字节
2. 利用 nasm 汇编器将其编译为 二进制文件（.bin）
3. 利用 dd 命令 将二进制文件写入虚拟硬盘第一扇区
4. bochs 自带 BIOS 会将其从硬盘第一扇区中加载到 0x7c00 处 
5. **此版本功能**：**利用BIOS建立的中断，打印字符串**

### hd.img

虚拟硬盘文件 ata0，Primary通道，主盘

## 学习心得

### 计算机的启动过程

1. 开机的一瞬间，CPU的cs:ip寄存器就被强制初始化为0xF000:0xFFF0，此处有跳转指令，会跳转到0xfe05b处，进入BIOS。
2. BIOS检测内存，显卡等外设信息，之后初始化硬件，在低地址处建立数据结构，中断向量表IVT并填写中断例程。
3. 最后校验启动盘中位于0盘0道1扇区的内容，如果最后两字节是0x55和0xaa,便将该程序(MBR)加载到物理地址0x7c00处，并跳转。
4. **此程序**中的MBR利用BIOS在第二步建立好的中断例程，实现打印字符的功能，从而证明我们MBR确实被BIOS从磁盘加载到了内存中。具体的中断号的使用方法上网查BIOS.

### 基础知识

1. 作为最开始的部分，环境的搭建算是重头戏。关于bochs的配置安装，书中有比较详细的介绍，这里只记录个人实践的心得体会。在配置bochs的启动文件时，最好参考的是官方自带的样本文件的参数配置bochsrc-sample.text，因为大家安装的可能是不同版本，版本不一，参数的输入描述也不一样。
2. BIOS:Base Input & Output System，基本输入输出系统，功能就是前面已经提到
3. **实模式下的内存布局**：一般整个内存空间由好几部分组成，比如我们电脑中装的内存条，属于DRAM,动态随机访问内存，还有显存，硬盘控制器等
4. MBR 主引导程序　因为MBR最大也就512字节(一个扇区),没法为内核准备好环境，更没办法将内核加载到内存中，所以真正加载内核的任务要交给另一个程序，而MBR的作用就是将这个程序加载到内存中，并转交控制权。